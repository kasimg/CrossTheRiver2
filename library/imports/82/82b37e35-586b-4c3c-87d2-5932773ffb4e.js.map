{"version":3,"sources":["..\\..\\..\\..\\assets\\Script/assets\\Script\\MainScript.js"],"names":["cc","Class","extends","Component","properties","animalPrefab","default","type","Prefab","tigers","deers","boat","Node","riverBankInfo","GoBtn","creatActors","i","tiger","instantiate","loader","loadRes","SpriteFrame","err","spriteFrame","getComponent","Sprite","mainScript","animalIndex","animalType","node","addChild","push","deer","setActorPos","length","posX","Data","tigerPositionLeft","x","posY","y","setPosition","deerPositionLeft","boatPositionLeft","initRiverBankInfo","left","tigerNum","deerNum","right","initBackground","bindGoEvent","on","EventType","MOUSE_DOWN","onGoBtnClicked","removeGoEvent","off","Math","abs","sailTo","ifGameOver","gameOver","removeAnimalClickEvent","removeClickEvent","bindAnimalClickEvent","bindClickEvent","pos","boatIns","boatStr","passageStr","boatSailAction","sail","delX","delY","se","sequence","callFunc","runAction","passages","seats","seatIndex","boatInfo","console","log","onLoad","start","update","dt"],"mappings":"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","file":"MainScript.js","sourceRoot":"..\\..\\..\\..\\assets\\Script","sourcesContent":["// Learn cc.Class:\r\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/class.html\r\n//  - [English] http://docs.cocos2d-x.org/creator/manual/en/scripting/class.html\r\n// Learn Attribute:\r\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\r\n//  - [English] http://docs.cocos2d-x.org/creator/manual/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\r\n//  - [English] https://www.cocos2d-x.org/docs/creator/manual/en/scripting/life-cycle-callbacks.html\r\nimport Data from 'static/Data';\r\ncc.Class({\r\n  extends: cc.Component,\r\n\r\n  properties: {\r\n    animalPrefab: {\r\n      default: null,\r\n      type: cc.Prefab,\r\n    },\r\n    // deerPrefab: {\r\n    //   default: null,\r\n    //   type: cc.Prefab,\r\n    // },\r\n    tigers: [],  //  存放3只老虎\r\n    deers: [],  //  存放3只鹿\r\n    boat: {\r\n      default: null,\r\n      type: cc.Node,\r\n    },\r\n    riverBankInfo: {\r\n      default: null,\r\n    },  //  存放两边岸上的情况\r\n    GoBtn: {\r\n      default: null,\r\n      type: cc.Node,\r\n    },\r\n  },\r\n\r\n  //  创建角色\r\n  creatActors() {\r\n    //  创建老虎\r\n    for (let i = 0; i < 3; i++) {\r\n      //  创建老虎\r\n      const tiger = cc.instantiate(this.animalPrefab);\r\n      cc.loader.loadRes('tiger', cc.SpriteFrame, (err, spriteFrame) => {\r\n        tiger.getComponent(cc.Sprite).spriteFrame = spriteFrame;\r\n      });\r\n\r\n      tiger.getComponent('Animal').mainScript = this;\r\n      tiger.getComponent('Animal').animalIndex = i;\r\n      tiger.getComponent('Animal').animalType = 'tiger';\r\n      this.node.addChild(tiger);\r\n      this.tigers.push(tiger);\r\n    }\r\n\r\n    //  创建鹿\r\n    for (let i = 0; i < 3; i++) {\r\n      //  创建鹿\r\n      const deer = cc.instantiate(this.animalPrefab);\r\n      cc.loader.loadRes('deer', cc.SpriteFrame, (err, spriteFrame) => {\r\n        deer.getComponent(cc.Sprite).spriteFrame = spriteFrame;\r\n      });\r\n\r\n      deer.getComponent('Animal').mainScript = this;\r\n      deer.getComponent('Animal').animalIndex = i;\r\n      deer.getComponent('Animal').animalType = 'deer';\r\n      this.node.addChild(deer);\r\n      this.deers.push(deer);\r\n    }\r\n  },\r\n\r\n  //  设置老虎和鹿的初始位置\r\n  setActorPos() {\r\n    for (let i = 0; i < this.tigers.length; i++) {\r\n      const tiger = this.tigers[i];\r\n      let posX = Data.tigerPositionLeft[i].x;\r\n      let posY = Data.tigerPositionLeft[i].y;\r\n\r\n      // tiger.x = posX;\r\n      // tiger.y = posY;\r\n\r\n      tiger.setPosition(posX, posY);\r\n\r\n      const deer = this.deers[i];\r\n      posX = Data.deerPositionLeft[i].x;\r\n      posY = Data.deerPositionLeft[i].y;\r\n\r\n      // deer.x = posX;\r\n      // deer.y = posY;\r\n      // console.log(deer.x, deer.y);\r\n      deer.setPosition(posX, posY);\r\n\r\n    }\r\n\r\n    //  设置船的初始位置\r\n    this.boat.setPosition(Data.boatPositionLeft.x, Data.boatPositionLeft.y);\r\n  },\r\n\r\n  //  初始化河岸数组\r\n  initRiverBankInfo() {\r\n    this.riverBankInfo = {\r\n      left: {\r\n        tigerNum: 3,\r\n        deerNum: 3,\r\n      },\r\n      right: {\r\n        tigerNum: 0,\r\n        deerNum: 0,\r\n      },\r\n    };\r\n  },\r\n\r\n  //  初始化界面\r\n  initBackground() {\r\n    this.creatActors();\r\n    this.setActorPos();\r\n    this.initRiverBankInfo();\r\n  },\r\n\r\n  //  绑定GO按钮点击事件\r\n  bindGoEvent() {\r\n    this.GoBtn.on(cc.Node.EventType.MOUSE_DOWN, this.onGoBtnClicked, this);\r\n  },\r\n\r\n  //  解除GO按钮点击事件\r\n  removeGoEvent() {\r\n    this.GoBtn.off(cc.Node.EventType.MOUSE_DOWN, this.onGoBtnClicked, this);\r\n  },\r\n\r\n  //  点击GO之后的事件\r\n  onGoBtnClicked() {\r\n    // console.log('点击了一次');\r\n    //  根据船的位置确定往哪里走，实际操作中有可能出现误差，所以这里给出一定的余地\r\n    if (Math.abs(this.boat.x - Data.boatPositionLeft.x) < 10) {  //  如果在左边\r\n      //  移动船\r\n      this.sailTo('right');\r\n      if (this.ifGameOver('left')) {\r\n        this.gameOver();\r\n      }\r\n    } else {\r\n      this.sailTo('left');\r\n    }\r\n  },\r\n\r\n  //  移除所有动物的点击事件\r\n  removeAnimalClickEvent() {\r\n    for (let i = 0; i < this.tigers.length; i++) {\r\n      this.tigers[i].getComponent('Animal').removeClickEvent();\r\n      this.deers[i].getComponent('Animal').removeClickEvent();\r\n    }\r\n  },\r\n\r\n  //  绑定多有动物的点击事件\r\n  bindAnimalClickEvent() {\r\n    for (let i = 0; i < this.tigers.length; i++) {\r\n      this.tigers[i].getComponent('Animal').bindClickEvent();\r\n      this.deers[i].getComponent('Animal').bindClickEvent();\r\n    }\r\n  },\r\n\r\n  //  点击按钮移动船\r\n  sailTo(pos) {\r\n    const boatIns = this.boat.getComponent('Boat');\r\n    const boatStr = 'boatPosition' + (pos === 'right' ? 'Right' : 'Left');\r\n    const passageStr = pos + 'Pos';\r\n    // console.log(Data[boatStr], boatStr);\r\n    // console.log(pos);\r\n    // console.log('从', {x: this.boat.x, y: this.boat.y}, '开往', Data[boatStr])\r\n    const boatSailAction = boatIns.sail({\r\n      delX: Data[boatStr].x - this.boat.x,\r\n      delY: Data[boatStr].y - this.boat.y,\r\n    });\r\n\r\n    //  移除点击事件，防止连续点击\r\n    this.removeGoEvent();\r\n    this.removeAnimalClickEvent();\r\n    const se = cc.sequence(boatSailAction, cc.callFunc(() => {\r\n      // console.log('动作执行完毕');\r\n      //  动作执行完之后，重新绑定事件\r\n      this.bindGoEvent();\r\n      this.bindAnimalClickEvent();\r\n\r\n      //  判断是否游戏结束\r\n      // if(this.ifGameOver(pos)) {\r\n      //   this.gameOver();\r\n      // } else {\r\n      //   console.log('继续');\r\n      // }\r\n    }, this));\r\n    this.boat.runAction(se);\r\n\r\n    const passages = boatIns.passages;\r\n    // if (!boatIns.isEmpty()) {\r\n    for (let i = 0; i < passages.length; i++) {\r\n      if (passages[i]) {\r\n        passages[i].sail({\r\n          delX: boatIns.seats[passages[i].seatIndex][passageStr].x - passages[i].node.x,\r\n          delY: boatIns.seats[passages[i].seatIndex][passageStr].y - passages[i].node.y,\r\n        });\r\n      }\r\n\r\n    }\r\n    // }\r\n  },\r\n\r\n  // 判定游戏是否结束\r\n  //  pos表示判断哪一岸的情况\r\n  ifGameOver(pos) {\r\n    const boatInfo = this.boat.getComponent('Boat');\r\n    console.log(this.riverBankInfo, boatInfo);\r\n    if (this.riverBankInfo[pos].tigerNum + boatInfo.boatInfo.tigerNum\r\n      > this.riverBankInfo[pos].deerNum + boatInfo.boatInfo.deerNum) return true;\r\n    return false;\r\n  },\r\n\r\n  //  游戏结束时执行\r\n  gameOver() {\r\n    console.log('game over');\r\n  },\r\n\r\n  onLoad() {\r\n    this.initBackground();\r\n    this.bindGoEvent();\r\n    // console.log(this.tigers[0]);\r\n    // console.log(this.tigers[0]);\r\n    // this.tigers[0].getComponent('Animal').jump();\r\n  },\r\n\r\n  start() {\r\n\r\n  },\r\n\r\n  update(dt) {\r\n    // console.log(this.tigers[0]);\r\n    // this.tigers[0].getComponent('Animal').jump();\r\n  },\r\n});\r\n"]}