window.__require=function t(e,n,i){function o(a,c){if(!n[a]){if(!e[a]){var r=a.split("/");if(r=r[r.length-1],!e[r]){var u="function"==typeof __require&&__require;if(!c&&u)return u(r,!0);if(s)return s(r,!0);throw new Error("Cannot find module '"+a+"'")}}var l=n[a]={exports:{}};e[a][0].call(l.exports,function(t){return o(e[a][1][t]||t)},l,l.exports,t,e,n,i)}return n[a].exports}for(var s="function"==typeof __require&&__require,a=0;a<i.length;a++)o(i[a]);return o}({Animal:[function(t,e,n){"use strict";cc._RF.push(e,"39049FDSS5DxI+Q4YZRMzOy","Animal");var i=function(t){return t&&t.__esModule?t:{default:t}}(t("Data"));cc.Class({extends:cc.Component,properties:{},atLeft:function(){var t="tiger"===this.animalType?i.default.tigerPositionLeft[this.animalIndex]:i.default.deerPositionLeft[this.animalIndex];return Math.abs(this.node.x-t.x)<10},jump:function(t){var e=this,n=t.delX,i=void 0===n?0:n,o=t.delY,s=void 0===o?0:o,a=cc.moveBy(1,cc.v2(i,s)).easing(cc.easeCubicActionOut());this.mainScript.removeAnimalClickEvent(),this.node.runAction(cc.sequence(a,cc.callFunc(function(){e.mainScript.ifSucceeded()&&e.mainScript.succeed(),e.mainScript.bindAnimalClickEvent()},this)))},getOnTheBoatFrom:function(t){var e=this.mainScript.boat.getComponent("Boat"),n=e.searchSeat();-1!==n&&(e.getOn(this,n),this.jump(this.computeDelPos({x:this.node.x,y:this.node.y},e.seats[this.seatIndex]["left"===t?"leftPos":"rightPos"])))},getOffTheBoatFrom:function(t){this.mainScript.boat.getComponent("Boat").getOff(this,this.seatIndex);var e="tiger"===this.animalType?"tigerPosition":"deerPosition",n="left"===t?"Left":"Right";this.jump(this.computeDelPos({x:this.node.x,y:this.node.y},i.default[e+n][this.animalIndex]))},updateAnimalNum:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this.mainScript.riverBankInfo,i=this.mainScript.boat.getComponent("Boat").boatInfo,o=this.animalType+"Num",s=e?1:-1;n[t][o]-=1*s,i[o]+=1*s},sail:function(t){var e=t.delX,n=t.delY,i=cc.moveBy(1,cc.v2(e,n)).easing(cc.easeCubicActionOut());this.node.runAction(i)},onClicked:function(){this.mainScript.boat.getComponent("Boat").atLeft()?this.onBoat?(this.getOffTheBoatFrom("left"),this.updateAnimalNum("left",!1)):this.atLeft()&&(this.getOnTheBoatFrom("left"),this.updateAnimalNum("left")):this.onBoat?(this.getOffTheBoatFrom("right"),this.updateAnimalNum("right",!1)):this.atLeft()||(this.getOnTheBoatFrom("right"),this.updateAnimalNum("right"))},computeDelPos:function(t,e){var n=t.x,i=t.y;return{delX:e.x-n,delY:e.y-i}},bindClickEvent:function(){this.node.on(cc.Node.EventType.MOUSE_DOWN,this.onClicked,this)},removeClickEvent:function(){this.node.off(cc.Node.EventType.MOUSE_DOWN,this.onClicked,this)},onMouseEnter:function(){var t=this;cc.game.canvas.style.cursor="pointer";var e=cc.scaleBy(.2,1.2),n=cc.scaleBy(.3,5/6);this.removeMouseEnterEvent();var i=cc.sequence(e,n,cc.callFunc(function(){t.bindMouseEnterEvent()},this));this.node.runAction(i);var o="tiger"===this.animalType?"tigerRoar":"deerSound";this.node.parent.getChildByName("audioControl").getComponent("AudioControl")[o].play()},onMouseLeave:function(){cc.game.canvas.style.cursor="default"},bindMouseEnterEvent:function(){this.node.on(cc.Node.EventType.MOUSE_ENTER,this.onMouseEnter,this),this.node.on(cc.Node.EventType.MOUSE_LEAVE,this.onMouseLeave,this)},removeMouseEnterEvent:function(){this.node.off(cc.Node.EventType.MOUSE_ENTER,this.onMouseEnter,this)},eatDeer:function(t){var e=t.delX,n=t.delY;return cc.moveBy(1,e,n)},onLoad:function(){this.bindClickEvent(),this.bindMouseEnterEvent()},start:function(){}}),cc._RF.pop()},{Data:"Data"}],AudioControl:[function(t,e,n){"use strict";cc._RF.push(e,"926117TetVE85WiFib40+8Q","AudioControl"),cc.Class({extends:cc.Component,properties:{tigerRoar:{default:null,type:cc.AudioSource},deerSound:{default:null,type:cc.AudioSource}},start:function(){}}),cc._RF.pop()},{}],Boat:[function(t,e,n){"use strict";cc._RF.push(e,"4c891A22JdPSa1tfq1qe617","Boat");var i=function(t){return t&&t.__esModule?t:{default:t}}(t("Data"));cc.Class({extends:cc.Component,properties:{passages:[],boatInfo:{default:null}},initSeats:function(){this.seats=[];for(var t=0;t<3;t++)this.seats.push({index:t,leftPos:{x:i.default.passagePositionLeft[t].x,y:i.default.passagePositionLeft[t].y},rightPos:{x:i.default.passagePositionRight[t].x,y:i.default.passagePositionRight[t].y},occupied:!1})},initBoatStatus:function(){this.boatInfo={tigerNum:0,deerNum:0}},atLeft:function(){return Math.abs(this.node.x-i.default.boatPositionLeft.x)<10},hasDeer:function(){for(var t=0;t<this.passages.length;t++)if(this.passages[t]&&"deer"===this.passages[t].animalType)return!0;return!1},searchSeat:function(){for(var t=0;t<this.seats.length;t++)if(!this.seats[t].occupied)return t;return-1},isEmpty:function(){for(var t=0,e=0;e<this.passages.length;e++)this.passages[e]&&t++;return t<1},getOn:function(t,e){this.seats[e].occupied=!0,this.passages[e]=t,t.onBoat=!0,t.seatIndex=e},getOff:function(t,e){this.seats[e].occupied=!1,this.passages[e]=null,t.onBoat=!1,t.seatIndex=-1},sail:function(t){var e=t.delX,n=t.delY;return cc.moveBy(1,cc.v2(e,n)).easing(cc.easeCubicActionOut())},onLoad:function(){this.initSeats(),this.initBoatStatus()},start:function(){}}),cc._RF.pop()},{Data:"Data"}],Data:[function(t,e,n){"use strict";cc._RF.push(e,"941c6EAKJdF7LBVF0jfqU94","Data"),Object.defineProperty(n,"__esModule",{value:!0}),n.default={tigerPositionLeft:[{x:-444,y:250},{x:-444,y:142},{x:-444,y:35}],tigerPositionRight:[{x:295,y:-42},{x:295,y:-150},{x:295,y:-257}],deerPositionLeft:[{x:-333,y:250},{x:-333,y:142},{x:-333,y:35}],deerPositionRight:[{x:406,y:-42},{x:406,y:-150},{x:406,y:-257}],boatPositionLeft:{x:-107,y:165},boatPositionRight:{x:55,y:-101},passagePositionLeft:[{x:-180,y:178},{x:-109,y:178},{x:-39,y:178}],passagePositionRight:[{x:-18,y:-88},{x:53,y:-88},{x:123,y:-88}]},e.exports=n.default,cc._RF.pop()},{}],GameOver:[function(t,e,n){"use strict";cc._RF.push(e,"182fcnI9I9GhZL8aPz7SzWi","GameOver"),cc.Class({extends:cc.Component,properties:{restartBtn:{default:null,type:cc.Button}},onMouseEnter:function(){cc.game.canvas.style.cursor="pointer",this.restartBtn.node.children[0].children[0].scale=1.5,this.restartBtn.node.children[0].children[0].rotation=10},onMouseLeave:function(){cc.game.canvas.style.cursor="default",this.restartBtn.node.children[0].children[0].scale=1,this.restartBtn.node.children[0].children[0].rotation=0},onMouseClicked:function(){cc.director.loadScene("stage")},bindRestartEvent:function(){this.restartBtn.node.on(cc.Node.EventType.MOUSE_ENTER,this.onMouseEnter,this),this.restartBtn.node.on(cc.Node.EventType.MOUSE_LEAVE,this.onMouseLeave,this),this.restartBtn.node.on(cc.Node.EventType.MOUSE_DOWN,this.onMouseClicked,this)},onLoad:function(){this.bindRestartEvent()},start:function(){}}),cc._RF.pop()},{}],MainScript:[function(t,e,n){"use strict";cc._RF.push(e,"82b3741WGtMPIfSWTJ3P/tO","MainScript");var i=function(t){return t&&t.__esModule?t:{default:t}}(t("Data"));cc.Class({extends:cc.Component,properties:{animalPrefab:{default:null,type:cc.Prefab},tigers:[],deers:[],boat:{default:null,type:cc.Node},riverBankInfo:{default:null},GoBtn:{default:null,type:cc.Node},rulesBtn:{default:null,type:cc.Label},ruleContext:{default:null,type:cc.RichText}},creatActors:function(){for(var t=this,e=function(e){var n=cc.instantiate(t.animalPrefab);cc.loader.loadRes("tiger",cc.SpriteFrame,function(t,e){n.getComponent(cc.Sprite).spriteFrame=e}),n.getComponent("Animal").mainScript=t,n.getComponent("Animal").animalIndex=e,n.getComponent("Animal").animalType="tiger",t.node.addChild(n),t.tigers.push(n)},n=0;n<3;n++)e(n);var i=function(e){var n=cc.instantiate(t.animalPrefab);cc.loader.loadRes("deer",cc.SpriteFrame,function(t,e){n.getComponent(cc.Sprite).spriteFrame=e}),n.getComponent("Animal").mainScript=t,n.getComponent("Animal").animalIndex=e,n.getComponent("Animal").animalType="deer",t.node.addChild(n),t.deers.push(n)};for(n=0;n<3;n++)i(n)},setActorPos:function(){for(var t=0;t<this.tigers.length;t++){var e=this.tigers[t],n=i.default.tigerPositionLeft[t].x,o=i.default.tigerPositionLeft[t].y;e.setPosition(n,o);var s=this.deers[t];n=i.default.deerPositionLeft[t].x,o=i.default.deerPositionLeft[t].y,s.setPosition(n,o)}this.boat.setPosition(i.default.boatPositionLeft.x,i.default.boatPositionLeft.y)},initRiverBankInfo:function(){this.riverBankInfo={left:{tigerNum:3,deerNum:3},right:{tigerNum:0,deerNum:0}}},initBackground:function(){this.creatActors(),this.setActorPos(),this.initRiverBankInfo()},bindGoEvent:function(){this.GoBtn.on(cc.Node.EventType.MOUSE_DOWN,this.onGoBtnClicked,this)},removeGoEvent:function(){this.GoBtn.off(cc.Node.EventType.MOUSE_DOWN,this.onGoBtnClicked,this)},onMouseEnter:function(){cc.game.canvas.style.cursor="pointer",this.GoBtn.scale=.21},onMouseLeave:function(){cc.game.canvas.style.cursor="default",this.GoBtn.scale=.19},bindEnterAndLeave:function(){this.GoBtn.on(cc.Node.EventType.MOUSE_ENTER,this.onMouseEnter,this),this.GoBtn.on(cc.Node.EventType.MOUSE_LEAVE,this.onMouseLeave,this)},onGoBtnClicked:function(){this.boat.getComponent("Boat").hasDeer()&&(Math.abs(this.boat.x-i.default.boatPositionLeft.x)<10?(this.sailTo("right"),this.ifGameOver("left","leave")&&this.gameOver("left","leave")):(this.sailTo("left"),this.ifGameOver("right","leave")&&this.gameOver("right","leave")))},removeAnimalClickEvent:function(){for(var t=0;t<this.tigers.length;t++)this.tigers[t].getComponent("Animal").removeClickEvent(),this.deers[t].getComponent("Animal").removeClickEvent()},bindAnimalClickEvent:function(){for(var t=0;t<this.tigers.length;t++)this.tigers[t].getComponent("Animal").bindClickEvent(),this.deers[t].getComponent("Animal").bindClickEvent()},sailTo:function(t){var e=this,n=(!(arguments.length>1&&void 0!==arguments[1])||arguments[1],this.boat.getComponent("Boat")),o="boatPosition"+("right"===t?"Right":"Left"),s=t+"Pos",a=n.sail({delX:i.default[o].x-this.boat.x,delY:i.default[o].y-this.boat.y});this.removeGoEvent(),this.removeAnimalClickEvent();var c=cc.sequence(a,cc.callFunc(function(){e.bindGoEvent(),e.bindAnimalClickEvent(),console.log(e.riverBankInfo),e.ifGameOver(t,"arrive")?e.gameOver(t,"arrive"):console.log("\u7ee7\u7eed")},this));this.boat.runAction(c);for(var r=n.passages,u=0;u<r.length;u++)r[u]&&r[u].sail({delX:n.seats[r[u].seatIndex][s].x-r[u].node.x,delY:n.seats[r[u].seatIndex][s].y-r[u].node.y})},ifGameOver:function(t,e){var n=this.boat.getComponent("Boat");if("leave"===e){if(this.riverBankInfo[t].deerNum<1)return!1;if(this.riverBankInfo[t].tigerNum>this.riverBankInfo[t].deerNum)return!0}else{if(this.riverBankInfo[t].deerNum+n.boatInfo.deerNum<1)return!1;if(this.riverBankInfo[t].tigerNum+n.boatInfo.tigerNum>this.riverBankInfo[t].deerNum+n.boatInfo.deerNum)return!0}return!1},gameOver:function(t,e){var n=this,i=[],o=[];"left"===t?(this.tigers.forEach(function(t){t.getComponent("Animal").atLeft()&&i.push(t)}),this.deers.forEach(function(t){t.getComponent("Animal").atLeft()&&o.push(t)})):(this.tigers.forEach(function(t){t.getComponent("Animal").atLeft()||t.getComponent("Animal").onBoat||i.push(t)}),this.deers.forEach(function(t){t.getComponent("Animal").atLeft()||t.getComponent("Animal").onBoat||o.push(t)})),"arrive"===e&&this.boat.getComponent("Boat").passages.forEach(function(t){t&&("tiger"===t.animalType?i.push(t.node):o.push(t.node))}),console.log(i,o);for(var s=function(t){var e=i[t].getComponent("Animal").eatDeer({delX:o[t].x-i[t].x,delY:o[t].y-i[t].y}),s=cc.sequence(e,cc.callFunc(function(){o[t].opacity=0,0===t&&cc.director.loadScene("gameOver")},n));i[t].runAction(s)},a=0;a<o.length;a++)s(a)},ifSucceeded:function(){return this.riverBankInfo.right.tigerNum+this.riverBankInfo.right.deerNum===6},succeed:function(){cc.director.loadScene("succeed")},showRules:function(){var t=255===this.ruleContext.node.opacity?0:255;cc.tween(this.ruleContext.node).to(.5,{opacity:t}).start()},onRulesBtnClick:function(){this.showRules()},onRulesBtnHover:function(){cc.game.canvas.style.cursor="pointer"},onRulesBtnLeave:function(){cc.game.canvas.style.cursor="default"},bindRulesBtnEvent:function(){this.rulesBtn.node.on(cc.Node.EventType.MOUSE_DOWN,this.onRulesBtnClick,this),this.rulesBtn.node.on(cc.Node.EventType.MOUSE_ENTER,this.onRulesBtnHover,this),this.rulesBtn.node.on(cc.Node.EventType.MOUSE_LEAVE,this.onRulesBtnLeave,this)},onLoad:function(){this.initBackground(),this.bindGoEvent(),this.bindEnterAndLeave(),this.bindRulesBtnEvent(),this.ruleContext.node.opacity=0,this.ruleContext.node.zindex=99},start:function(){},update:function(t){}}),cc._RF.pop()},{Data:"Data"}],Succeed:[function(t,e,n){"use strict";cc._RF.push(e,"d0ed2WYXfJIAIFBtFDVHlGh","Succeed"),cc.Class({extends:cc.Component,properties:{againBtn:{default:null,type:cc.Label}},onMouseEnter:function(){cc.game.canvas.style.cursor="pointer",this.againBtn.node.scale=1.5,this.againBtn.node.rotation=-10},onMouseLeave:function(){cc.game.canvas.style.cursor="default",this.againBtn.node.scale=1,this.againBtn.node.rotation=0},onMouseDown:function(){cc.director.loadScene("stage")},bindEvents:function(){this.againBtn.node.on(cc.Node.EventType.MOUSE_ENTER,this.onMouseEnter,this),this.againBtn.node.on(cc.Node.EventType.MOUSE_LEAVE,this.onMouseLeave,this),this.againBtn.node.on(cc.Node.EventType.MOUSE_DOWN,this.onMouseDown,this)},onLoad:function(){this.bindEvents()},start:function(){}}),cc._RF.pop()},{}]},{},["Animal","AudioControl","Boat","Data","GameOver","MainScript","Succeed"]);